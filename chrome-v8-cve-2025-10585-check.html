<!doctype html>
<meta charset="utf-8">
<title>Chromium/V8 CVE-2025-10585 quick check</title>
<style>
  :root { --ok:#0a0; --warn:#a60; --bad:#c00; --muted:#666; }
  body { font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 820px; margin: 2rem auto; padding: 0 1rem; }
  h1 { font-size: 1.2rem; margin: 0 0 1rem; color: #111; }
  .card { border: 1px solid #eee; border-radius: 12px; padding: 1rem; }
  .status { font: 1rem monospace; padding: .4rem .6rem; border-radius: .5rem; display: inline-block; }
  .ok { background: #e9f7e9; color: var(--ok); }
  .bad { background: #fdeaea; color: var(--bad); }
  .warn{ background: #fff4e6; color: var(--warn); }
  .muted{ color: var(--muted); }
  code { background:#f6f6f6; padding:.1rem .35rem; border-radius:.35rem; }
  ul { margin:.6rem 0 .2rem 1.2rem; }
  .kv { display:grid; grid-template-columns: 190px 1fr; gap:.35rem .75rem; margin-top:.75rem; }
  .kv div:nth-child(odd){ color:#444; }
  .small { font-size:.9rem; color:#444; }
</style>
<div class="card">
  <h1>CVE-2025-10585 (V8 type confusion) quick check</h1>
  <div id="status" class="status muted">checking…</div>
  <div class="kv" id="details"></div>
  <p class="small">Notes: iOS Chrome uses WebKit (not V8). The fix landed in Chrome 140.0.7339.185/.186. Risk was highest on ARM64 builds.</p>
</div>
<script>
(function(){
  const FIXED = [140,0,7339,185];  // Chrome version with the fix

  function cmp(a,b){for(let i=0;i<4;i++){const d=(a[i]||0)-(b[i]||0); if(d) return Math.sign(d);} return 0;}
  function parseChromiumVersion(){
    const ua = navigator.userAgent;
    // Prefer "Chromium/x" then "Chrome/x". Edge/Brave include "Chrome/x", which is fine for engine version.
    let m = ua.match(/\bChromium\/(\d+)\.(\d+)\.(\d+)\.(\d+)\b/);
    if(!m) m = ua.match(/\bChrome\/(\d+)\.(\d+)\.(\d+)\.(\d+)\b/);
    if(!m) return null; return m.slice(1).map(Number);
  }
  function isIOS(){ return /\b(iPhone|iPad|iPod)\b/.test(navigator.userAgent) || /\biOS\b/.test(navigator.userAgent); }
  function isChromiumLike(){
    const ua = navigator.userAgent;
    return /\b(Chromium|Chrome)\/\d/.test(ua) && !/CriOS\/\d/.test(ua); // exclude iOS Chrome token
  }
  async function archHint(){
    try{
      // UA-CH if available
      const d = navigator.userAgentData || {};
      if (d.getHighEntropyValues){
        const v = await d.getHighEntropyValues(['architecture','platform','platformVersion','model','uaFullVersion']);
        return (v.architecture||'').toLowerCase();
      }
      // Fallback to UA sniff
      const s = navigator.userAgent.toLowerCase() + " " + (navigator.platform||"").toLowerCase();
      if (/(arm|aarch64|android)/.test(s)) return 'arm';
      return 'other';
    }catch{ return 'unknown'; }
  }

  (async function run(){
    const ver = parseChromiumVersion();
    const ios = isIOS();
    const chromium = isChromiumLike();
    const arch = await archHint();

    const det = document.getElementById('details');
    const st = document.getElementById('status');

    function row(k,v){ const d=document.createElement('div'); d.textContent=k; det.appendChild(d); const e=document.createElement('div'); e.textContent=v; det.appendChild(e); }

    let verdict = {cls:'muted', text:'Unknown'};
    if (ios){
      verdict = {cls:'ok', text:'Not affected (iOS uses WebKit, not V8)'};
    } else if (!chromium){
      verdict = {cls:'ok', text:'Not Chromium/V8 → not affected by this CVE'};
    } else if (!ver){
      verdict = {cls:'warn', text:'Chromium-based but version undetected → update recommended'};
    } else if (cmp(ver, FIXED) >= 0){
      verdict = {cls:'ok', text:'Patched (version \u2265 140.0.7339.185)'};
    } else {
      // Older than fixed
      if (arch === 'arm') verdict = {cls:'bad', text:'Likely vulnerable (ARM64, version < 140.0.7339.185) → update now'};
      else verdict = {cls:'warn', text:'Behind patch level; highest risk was on ARM64 → update'};
    }

    st.className = 'status ' + verdict.cls;
    st.textContent = verdict.text;

    row('Detected engine version', ver ? ver.join('.') : 'n/a');
    row('Architecture hint', arch);
    row('Chromium-based', String(chromium));
    row('User-Agent', navigator.userAgent);
    if (navigator.userAgentData && navigator.userAgentData.brands){
      row('UA-CH brands', navigator.userAgentData.brands.map(b=>`${b.brand} ${b.version}`).join(', '));
    }
    row('Patched at', FIXED.join('.'));
  })();
})();
</script>
